syntax = "proto3";

package mos;

// 主服务：统一的机器人任务与遥测流接口
service Mos {
  // 一次性任务调度（请求 -> 响应）
  rpc ScheduleTask (TaskRequest) returns (TaskResponse);

  // 双向流式遥测通信（客户端可以发送 TelemetryRequest，服务端推送 TelemetryData）
  rpc StreamTelemetry (stream TelemetryRequest) returns (stream TelemetryData);

  // 设置机器人关节角度
  rpc SetJointAngles(SetJointAnglesRequest) returns (CommandResponse);

  // 获取机器人当前关节角度
  rpc GetJointAngles(GetJointAnglesRequest) returns (GetJointAnglesResponse);
}

//
// ================== Robot Control 模块 ==================
//
message SetJointAnglesRequest {
  repeated double angles = 1; // 目标关节角度列表
}

message GetJointAnglesRequest {}

message GetJointAnglesResponse {
  repeated double angles = 1; // 当前关节角度列表
}

message CommandResponse {
  bool success = 1;
  string message = 2;
}


//
// ================== Task 模块 ==================
//
message TaskRequest {
  optional int64 id = 1; // 任务 ID，客户端可选，由服务器分配
  uint32 priority = 2;    // 优先级
}

message TaskResponse {
  uint64 id = 1;          // 返回任务 ID（通常与请求一致）
}

//
// ================== Telemetry 模块 ==================
//
message TelemetryRequest {
  string sensor_id = 1;   // 传感器 ID，例如 "camera_1"、"lidar_2"
  bytes data = 2;         // 原始遥测数据（可选）
  uint64 timestamp = 3;    // 时间戳（Unix 秒）
}

// ✅ 新的 TelemetryData，用于流式下行
message TelemetryData {
  string source = 1;      // 数据来源，例如 "mock_sensor"
  double value = 2;       // 传感器数值
  uint64 timestamp = 3;    // 时间戳（秒）
}

//
// ================== 通用响应（可选扩展） ==================
//